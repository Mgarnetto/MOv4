@model MoozicOrb.Models.PageSettingsViewModel
@using MoozicOrb.Models
@using System.Collections.Generic

<div class="settings-grid-layout">
    <aside class="settings-sidebar">
        <h4 class="mb-4 text-white">Settings</h4>
        <nav class="settings-nav">
            <a href="/settings/account" class="settings-link">
                <i class="fas fa-user me-2"></i> Account
            </a>
            <a href="/settings/page" class="settings-link active">
                <i class="fas fa-magic me-2"></i> Page & Creator
            </a>
        </nav>
    </aside>

    <main class="settings-content">
        <div class="settings-panel">
            <h2 class="mb-4 border-bottom border-secondary pb-3">Creator Page</h2>

            <div class="mb-5">
                <label class="form-label text-muted small text-uppercase fw-bold mb-2">Cover Image</label>

                <div id="coverPreview" class="cover-preview mb-3"
                     data-current="@Model.CoverImage"
                     style="background-image: url('@Model.CoverImage'); height: 200px; background-size: cover; background-position: center; border-radius: 10px; border: 1px solid #333;">
                </div>

                <input type="file" id="coverUploadInput" style="display:none;" accept="image/*">
                <button class="btn-sidebar-outline btn-sm" onclick="document.getElementById('coverUploadInput').click()">
                    <i class="fas fa-upload me-2"></i> Upload New Cover
                </button>
            </div>

            <form id="pageSettingsForm">

                <div class="form-group mb-5">
                    <label class="form-label text-muted small text-uppercase fw-bold">Bio / Intro</label>
                    <textarea id="inputBio" class="form-control" rows="4" style="background: #000; color: white; border: 1px solid #333; min-height: 120px;">@Model.Bio</textarea>
                </div>

                <hr class="border-secondary my-5" />

                <h3 class="text-white mb-4">Identify As</h3>

                <div class="form-group mb-5">
                    <label class="form-label text-muted small text-uppercase fw-bold">Primary Role</label>
                    <select id="inputAccountTypePrimary" class="form-control" style="background: #000; color: white; border: 1px solid #333; height: 45px;">
                        <option value="">-- None --</option>
                        @if (ViewBag.AccountTypes != null)
                        {
                            foreach (var type in (List<AccountType>)ViewBag.AccountTypes)
                            {
                                <option value="@type.Id" selected="@(Model.AccountTypePrimary == type.Id)">@type.Name</option>
                            }
                        }
                    </select>
                </div>

                <div class="form-group mb-5">
                    <label class="form-label text-muted small text-uppercase fw-bold">Secondary Role</label>
                    <select id="inputAccountTypeSecondary" class="form-control" style="background: #000; color: white; border: 1px solid #333; height: 45px;">
                        <option value="">-- None --</option>
                        @if (ViewBag.AccountTypes != null)
                        {
                            foreach (var type in (List<AccountType>)ViewBag.AccountTypes)
                            {
                                <option value="@type.Id" selected="@(Model.AccountTypeSecondary == type.Id)">@type.Name</option>
                            }
                        }
                    </select>
                </div>

                <div class="form-group mb-5">
                    <label class="form-label text-muted small text-uppercase fw-bold">Primary Genre</label>
                    <select id="inputGenrePrimary" class="form-control" style="background: #000; color: white; border: 1px solid #333; height: 45px;">
                        <option value="">-- None --</option>
                        @if (ViewBag.Genres != null)
                        {
                            foreach (var g in (List<Genre>)ViewBag.Genres)
                            {
                                <option value="@g.Id" selected="@(Model.GenrePrimary == g.Id)">@g.Name</option>
                            }
                        }
                    </select>
                </div>

                <div class="form-group mb-5">
                    <label class="form-label text-muted small text-uppercase fw-bold">Secondary Genre</label>
                    <select id="inputGenreSecondary" class="form-control" style="background: #000; color: white; border: 1px solid #333; height: 45px;">
                        <option value="">-- None --</option>
                        @if (ViewBag.Genres != null)
                        {
                            foreach (var g in (List<Genre>)ViewBag.Genres)
                            {
                                <option value="@g.Id" selected="@(Model.GenreSecondary == g.Id)">@g.Name</option>
                            }
                        }
                    </select>
                </div>

                <hr class="border-secondary my-5" />

                <h3 class="text-white mb-4">Booking & Business</h3>

                <div class="form-group mb-5">
                    <label class="form-label text-muted small text-uppercase fw-bold">Booking Email</label>
                    <input type="text" id="inputEmail" class="form-control" value="@Model.BookingEmail" placeholder="booking@@..."
                           style="background: #000; color: white; border: 1px solid #333; height: 45px;">
                    <small class="text-muted d-block mt-1">Publicly visible on your page.</small>
                </div>

                <div class="form-group mb-5">
                    <label class="form-label text-muted small text-uppercase fw-bold">Booking Phone</label>
                    <input type="text" id="inputPhoneBooking" class="form-control" value="@Model.PhoneBooking" placeholder="+1..."
                           style="background: #000; color: white; border: 1px solid #333; height: 45px;">
                </div>

                <hr class="border-secondary my-5" />

                <div class="form-group mb-4">
                    <label class="form-label text-muted small text-uppercase fw-bold mb-3">Page Layout (Drag to Reorder)</label>
                    <div id="layoutSortContainer" class="layout-sort-container">
                        @{
                            var displayNames = new Dictionary<string, string> {
                                                { "posts", "Updates & Posts" },
                                                { "music", "Discography" },
                                                { "store", "Merch Store" }
                                                };
                        }

                        @if (Model.LayoutOrder != null && Model.LayoutOrder.Any())
                        {
                            foreach (var itemKey in Model.LayoutOrder)
                            {
                                if (displayNames.ContainsKey(itemKey))
                                {
                                    <div class="sort-item d-flex align-items-center mb-2 p-3"
                                         draggable="true"
                                         data-key="@itemKey"
                                         style="background: #111; border: 1px solid #333; border-radius: 5px; cursor: grab; user-select: none;">
                                        <i class="fas fa-grip-lines text-muted me-3"></i>
                                        <span class="text-white">@displayNames[itemKey]</span>
                                    </div>
                                }
                            }
                        }
                    </div>
                </div>

                <div class="form-actions text-end pt-3 border-top border-secondary">
                    <button type="submit" class="btn-sidebar-fill px-5 py-2">Save Changes</button>
                </div>
            </form>
        </div>
    </main>
</div>